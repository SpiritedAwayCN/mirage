// runtime.h - Runtime for Program Generated by Mirage
#pragma once

#include <cuda_runtime_api.h>

#include <vector>
// Will be generated by the transpiler
extern "C" void execute_mugraph(std::vector<void const *> input_tensors,
                                std::vector<void *> output_tensors,
                                void *buf);

#include "config.h"
#include "kernel/element_binary.h"
#include "kernel/element_unary.h"
#include "kernel/matmul.h"
#include "kernel/reduction.h"
#include "utils.h"

// A wrappr around `execute_mugraph`
void execute_mugraph_wrapper(void const *input_tensors[],
                             size_t num_input_tensors,
                             void *output_tensors[],
                             size_t num_output_tensors,
                             void *buf) {
  std::vector<void const *> input_tensors_vec(
      input_tensors, input_tensors + num_input_tensors);
  std::vector<void *> output_tensors_vec(output_tensors,
                                         output_tensors + num_output_tensors);
  execute_mugraph(input_tensors_vec, output_tensors_vec, buf);
}
